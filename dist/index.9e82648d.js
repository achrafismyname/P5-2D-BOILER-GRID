let grid,pixel,padding,resolution=10,bgColor=[31,34,87];function initGrid(t){padding=80,grid=Array2D(resolution),pixel=ceil((width-2*padding)/resolution),t||noStroke()}function updateGrid(){grid.forEach(((t,r)=>{t.forEach(((t,i)=>{t&&(fill(t),rect(padding+r*pixel,padding+i*pixel,pixel,pixel))}))}))}function setup(){const t=min(windowWidth/1.2,windowHeight/1.2);createCanvas(t,t),noLoop(),frameRate(1),colorMode(HSB),background("white")}function draw(){initGrid(!1),face();(new Eyes).update();(new Mouth).update(),updateGrid()}function face(){let t=random(["#ffceb4","#e1ac96","#b48a78","#87675a","#3c2e28"]),i=random()>.7;for(let o=0;o<resolution;o++)for(let s=0;s<resolution;s++){const e=random()>.5?o*resolution+s:s*resolution+o;grid[o][s]=i?NoiseColor(e/200):NoiseFromColor(t,e/r(50,100),50)}}class Mouth{startX=round(resolution/2)-round(resolution/4)-1;startY=resolution-round(resolution/4);endX=resolution-this.startX-1;endY=resolution-1;g=Array2D(resolution);constructor(){this.bg()}bg(){let t=r(0,this.endX-2),i=r(t+1,this.endX),o=r(0,2),s=r(o+1,3);for(let r=t;r<i;r++)for(let t=o;t<s;t++)this.g[this.startX+r][this.startY+t]="black";let e=r(t+1,i-1),n=r(e,i-1);for(let t=e;t<n;t++)for(let r=o;r<s;r++)this.g[this.startX+t][this.startY+r]="pink"}update(){grid=Mask2D(grid,this.g)}}class Eyes{startX=0;startY=1;endX=round(resolution/2)-2;endY=round(resolution/1.6);g=Array2D(resolution);eyeBrowColor="#101010";whiteColor="white";pupilColor="red";constructor(){random()>.1?this.brows():this.eyebrowY=0,this.eyes()}brows(){let t=r(0,this.endX-1),i=r(t+2,this.endX+1),o=i-t,s=o>2&&random()<.3,e=o>2&&random()<.7,n=o>2&&random()<.7;for(let o=t;o<i;o++)s&&(this.g[this.startX+o][this.startY+0+1]=this.eyeBrowColor),e&&(o==t||o==i-1&&!n)&&(this.g[this.startX+o][this.startY+0+r(-1,1)]=this.eyeBrowColor),n&&(o!=t&&o!=i-1||(this.g[this.startX+o+1][this.startY+0]=this.eyeBrowColor)),this.g[this.startX+o][this.startY+0]=this.eyeBrowColor;this.eyebrowY=this.startY+0}eyes(){let t=r(this.eyebrowY,this.endY-2),i=r(t+1,this.endY),o=r(0,this.endX),s=r(o+1,this.endX+1);const e=i-t,n=s-o;for(let r=o;r<s;r++)for(let o=t;o<i;o++)this.g[this.startX+r][this.startY+o]=this.whiteColor;let a=r(o,s-1),h=r(t,i-1),l=n<3&&random()>.9,d=!l&&e>1&&(n>1||2!=e)&&random()>.8,u=!l&&n>1&&random()>.8;l||(this.g[this.startX+a][this.startY+h]=this.pupilColor),d&&(this.g[this.startX+a][this.startY+h+(h==i-1?-1:1)]=this.pupilColor),u&&(this.g[this.startX+a+(a==s-1?-1:1)][this.startY+h]=this.pupilColor,d&&(this.g[this.startX+a+(a==s-1?-1:1)][this.startY+h+(h==i-1?-1:1)]=this.pupilColor))}update(){grid=Mask2D(grid,this.g);let t=random()>.5;grid=t?Mask2D(grid,Mirror2DX(this.g)):Mask2D(grid,Push2DX(this.g,resolution/2))}}